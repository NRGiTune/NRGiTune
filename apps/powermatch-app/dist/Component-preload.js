//@ui5-bundle energitune/powermatch/Component-preload.js
sap.ui.predefine("energitune/powermatch/Component", ["sap/ui/core/UIComponent","sap/ui/model/resource/ResourceModel","sap/ui/model/json/JSONModel"],(e,t,n)=>{"use strict";return e.extend("energitune.powermatch.Component",{metadata:{interfaces:["sap.ui.core.IAsyncContentCreation"],manifest:"json"},init(){e.prototype.init.apply(this,arguments);const i=new t({bundleName:"energitune.powermatch.i18n.i18n"});this.setModel(i,"i18n");fetch("data/powermatch_tarifas.csv").then(e=>e.text()).then(e=>{var t=e.split("\n").map(e=>e.split(","));var i=t[0];var a=t.slice(1).map(e=>{let t={};i.forEach((n,i)=>t[n.trim()]=e[i]?.trim());return t});var r=new n({rows:a});this.setModel(r,"tariffs")})}})});
sap.ui.predefine("energitune/powermatch/controller/Main.controller", ["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/model/json/JSONModel","energitune/powermatch/util/eRedesFileProcessor","energitune/powermatch/util/formatter"],(e,t,n,o,r)=>{"use strict";return e.extend("energitune.powermatch.controller.Main",{formatter:r,onInit:function(){this.getView().setModel(new n([]),"readingsModel")},onAfterRendering:function(){var e=document.getElementById("chartCanvas");if(!this._oConsumptionChart){this._oConsumptionChart=new Chart(e,{type:"pie",data:{labels:[this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("hdrTtlConsEmpty"),this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("hdrTtlConsRush"),this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("hdrTtlConsFull")],datasets:[{data:[0,0,0]}]}})}},onFileUpload:function(e){var t=e.getParameter("files")[0];var n=this;if(t&&window.FileReader){var r=new FileReader;r.onload=function(e){var t=o.parseEredesFile(n,e.target.result);n.getView().setModel(t,"readingsModel")};r.readAsArrayBuffer(t)}},onShowDescription(){const e=this.getView().getModel("i18n").getResourceBundle();const n=e.getText("appDescription");t.show(n)}})});
sap.ui.predefine("energitune/powermatch/util/eRedesFileProcessor copy", ["sap/base/Log","sap/ui/model/json/JSONModel"],function(t,e){"use strict";function a(t,e){const a=new Date(e);const r=t.filter(t=>{const e=new Date(t.startDate);const r=new Date(t.endDate);return a>=e&&a<=r});return r}function r(t,e){var r=t.oView.oParent.oModels.i18n.getResourceBundle();var s=e.slice(0,3).map((t,e)=>({[`hdr${e+1}`]:t[1]}));var o=e.slice(8).filter(t=>t[0]&&t[5]&&t[6]&&t[7]).map(t=>({date:t[0].split("/")[2]+"-"+t[0].split("/")[1]+"-"+t[0].split("/")[0],day:t[0].split("/")[0],readingEmpty:t[5],readingRush:t[6],readingFull:t[7]}));var n=o.sort((t,e)=>new Date(e.date)-new Date(t.date));var l=n[0].date;var i=new Date(l);var u=n[0];s.push({["hdrDateTo"]:u.date});n=o.sort((t,e)=>new Date(t.date)-new Date(e.date));var d=n[0].date;var c=new Date(d);var p=n[0];s.push({["hdrDateFrom"]:p.date});var h=n.filter(function(t){var e=new Date(t.date);return e.getDate()===1});if(c.getDate()===1){h.shift()}if(i.getDate()!==1){h.push(u)}var f=t.oView.oParent.oModels.tariffs.oData.rows;h.forEach(function(t,e,r){if(e===0){t.consEmpty=t.readingEmpty-p.readingEmpty;t.consRush=t.readingRush-p.readingRush;t.consFull=t.readingFull-p.readingFull}else{t.consEmpty=t.readingEmpty-r[e-1].readingEmpty;t.consRush=t.readingRush-r[e-1].readingRush;t.consFull=t.readingFull-r[e-1].readingFull}t.tariffs=a(f,t.date)});var m=h.reduce((t,e)=>{t.totalConsEmpty+=e.consEmpty||0;t.totalConsRush+=e.consRush||0;t.totalConsFull+=e.consFull||0;return t},{totalConsEmpty:0,totalConsRush:0,totalConsFull:0});s.push({["hdrTtlConsEmpty"]:m.totalConsEmpty});s.push({["hdrTtlConsRush"]:m.totalConsRush});s.push({["hdrTtlConsFull"]:m.totalConsFull});var y=document.getElementById("chartCanvas");var E;if(E){E.destroy()}E=new Chart(y,{type:"pie",data:{labels:[r.getText("hdrTtlConsEmpty"),r.getText("hdrTtlConsRush"),r.getText("hdrTtlConsFull")],datasets:[{data:[m.totalConsEmpty,m.totalConsRush,m.totalConsFull]}]}});var v=h.flatMap(t=>t.tariffs.map(e=>({...t,...e})));v.forEach(t=>delete t.tariffs);v.forEach(function(t,e,a){t.tariffSimple=(t.consEmpty+t.consRush+t.consFull)*t.priceSimple;t.tariffBiHourly=(t.consRush+t.consFull)*t.priceOutEmpty+t.consEmpty*t.priceEmpty;t.tariffTriHourly=t.consEmpty*t.priceEmpty+t.consRush*t.priceRush+t.consFull*t.priceFull});var g=v.reduce((t,e)=>{const a=e.id;if(!t[a]){t[a]={supplierName:e.name,tariff:e.description,totalSimple:0,totalBiHourly:0,totalTriHourly:0}}t[a].totalSimple+=e.tariffSimple;t[a].totalBiHourly+=e.tariffBiHourly;t[a].totalTriHourly+=e.tariffTriHourly;return t},{});var C={header:s,data:g};return C}return{parseEredesFile:function(a,s){try{var o=new Uint8Array(s);var n=XLSX.read(o,{type:"array"});var l=n.SheetNames[0];var i=n.Sheets[l];var u=XLSX.utils.sheet_to_json(i,{header:1});var d=[];switch(l){case"Leituras":d=r(a,u);break;default:}var c=new e(d);t.info("Excel carregado com sucesso");return c}catch(a){t.error("Erro ao processar Excel: "+a.message);return new e([])}}}});
//# sourceMappingURL=eRedesFileProcessor copy.js.map
sap.ui.predefine("energitune/powermatch/util/eRedesFileProcessor", ["sap/base/Log","sap/ui/model/json/JSONModel"],function(t,e){"use strict";function a(t,e){if(t._oConsumptionChart){var a=t.getOwnerComponent().getModel("i18n").getResourceBundle();var r=e.totalConsEmpty+e.totalConsRush+e.totalConsFull;t._oConsumptionChart.data.labels=[a.getText("hdrTtlConsEmpty"),a.getText("hdrTtlConsRush"),a.getText("hdrTtlConsFull")];t._oConsumptionChart.data.datasets[0].data=[[e.totalConsEmpty/r*100],[e.totalConsRush/r*100],[e.totalConsFull/r*100]];t._oConsumptionChart.update()}}function r(t,e){const a=new Date(e);const r=t.filter(t=>{const e=new Date(t.startDate);const r=new Date(t.endDate);return a>=e&&a<=r});return r}function o(t,e){var o=t.oView.oParent.oModels.i18n.getResourceBundle();var s=e.slice(0,3).map((t,e)=>({[`hdr${e+1}`]:t[1]}));var n=e.slice(8).filter(t=>t[0]&&t[5]&&t[6]&&t[7]).map(t=>({date:t[0].split("/")[2]+"-"+t[0].split("/")[1]+"-"+t[0].split("/")[0],day:t[0].split("/")[0],readingEmpty:t[5],readingRush:t[6],readingFull:t[7]}));var l=n.sort((t,e)=>new Date(e.date)-new Date(t.date));var u=l[0].date;var i=new Date(u);var d=l[0];s.push({["hdrDateTo"]:d.date});l=n.sort((t,e)=>new Date(t.date)-new Date(e.date));var p=l[0].date;var c=new Date(p);var h=l[0];s.push({["hdrDateFrom"]:h.date});var f=l.filter(function(t){var e=new Date(t.date);return e.getDate()===1});if(c.getDate()===1){f.shift()}if(i.getDate()!==1){f.push(d)}var m=t.oView.oParent.oModels.tariffs.oData.rows;f.forEach(function(t,e,a){if(e===0){t.consEmpty=t.readingEmpty-h.readingEmpty;t.consRush=t.readingRush-h.readingRush;t.consFull=t.readingFull-h.readingFull}else{t.consEmpty=t.readingEmpty-a[e-1].readingEmpty;t.consRush=t.readingRush-a[e-1].readingRush;t.consFull=t.readingFull-a[e-1].readingFull}t.tariffs=r(m,t.date)});var y=f.reduce((t,e)=>{t.totalConsEmpty+=e.consEmpty||0;t.totalConsRush+=e.consRush||0;t.totalConsFull+=e.consFull||0;return t},{totalConsEmpty:0,totalConsRush:0,totalConsFull:0});s.push({["hdrTtlConsEmpty"]:y.totalConsEmpty});s.push({["hdrTtlConsRush"]:y.totalConsRush});s.push({["hdrTtlConsFull"]:y.totalConsFull});s.push({["hdrTtlCons"]:y.totalConsEmpty+y.totalConsRush+y.totalConsFull});a(t,y);var C=f.flatMap(t=>t.tariffs.map(e=>({...t,...e})));C.forEach(t=>delete t.tariffs);C.forEach(function(t,e,a){t.tariffSimple=(t.consEmpty+t.consRush+t.consFull)*t.priceSimple;t.tariffBiHourly=(t.consRush+t.consFull)*t.priceOutEmpty+t.consEmpty*t.priceEmpty;t.tariffTriHourly=t.consEmpty*t.priceEmpty+t.consRush*t.priceRush+t.consFull*t.priceFull});var E=C.reduce((t,e)=>{const a=e.id;if(!t[a]){t[a]={supplierName:e.name,tariff:e.description,totalSimple:0,totalBiHourly:0,totalTriHourly:0}}t[a].totalSimple+=e.tariffSimple;t[a].totalBiHourly+=e.tariffBiHourly;t[a].totalTriHourly+=e.tariffTriHourly;return t},{});var g={header:s,data:E};return g}return{parseEredesFile:function(a,r){try{var s=new Uint8Array(r);var n=XLSX.read(s,{type:"array"});var l=n.SheetNames[0];var u=n.Sheets[l];var i=XLSX.utils.sheet_to_json(u,{header:1});var d=[];switch(l){case"Leituras":d=o(a,i);break;default:}var p=new e(d);t.info("Excel carregado com sucesso");return p}catch(a){t.error("Erro ao processar Excel: "+a.message);return new e([])}}}});
sap.ui.predefine("energitune/powermatch/util/formatter", [],function(){"use strict";return{formatCurrency:function(t,e="pt-PT",n="EUR"){if(t===null||t===undefined||isNaN(t)){return""}return new Intl.NumberFormat(e,{style:"currency",currency:n}).format(t)},formatDate:function(t,e="pt-PT"){if(!t){return""}let n=t instanceof Date?t:new Date(t);return n.toLocaleDateString(e,{day:"2-digit",month:"2-digit",year:"numeric"})}}});
sap.ui.require.preload({
	"energitune/powermatch/i18n/i18n.properties":'# App Descriptor\nappTitle=PowerMatch\nappDescription=O simulador PowerMatch permite comparar tarifas de energia em Portugal de forma simples e clara, cruzando dados reais do seu consumo, ajudando-o a encontrar a melhor oferta para o seu perfil de consumo.\n\n# eRedes readings header\nconsumptionPanel=Consumption (%)\nhdrTtlConsEmpty=Empty\nhdrTtlConsRush=Rush\nhdrTtlConsFull=Full\nhdrTtlCons=Total\n\ndetailsPanel=Details\nhdrDateFrom=Readings from\nhdrDateTo=to\nhdrCPE=CPE\nhdrCounterNr=Counter Nr\nhdrAddress=Address\n\nconsumptionPanelKwh=Consumption (kwh)\n\n\nfileUpdPalceHolder=Choose (.xlsx) file to upload \n\ncolHdrSupplierName=Supplier\ncolHdrTariff=Tariff\ncolHdrTotalSimple=Simple\ncolHdrTotalBiHourly=Bi-Hourly\ncolHdrTotalTriHourly=Tri-Hourly',
	"energitune/powermatch/i18n/i18n_en.properties":'# App Descriptor\nappTitle=PowerMatch [EN]\nappDescription=O simulador PowerMatch permite comparar tarifas de energia em Portugal de forma simples e clara, cruzando dados reais do seu consumo, ajudando-o a encontrar a melhor oferta para o seu perfil de consumo.',
	"energitune/powermatch/manifest.json":'{"_version":"1.65.0","sap.app":{"id":"energitune.powermatch","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":["","en"]},"title":"{{appTitle}}","description":"{{appDescription}}","type":"application","applicationVersion":{"version":"1.0.0"}},"sap.ui":{"technology":"OpenUI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"dependencies":{"minUI5Version":"1.108.0","libs":{"sap.ui.core":{},"sap.m":{},"sap.ui.layout":{},"sap.ui.unified":{}}},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"energitune.powermatch.i18n.i18n","supportedLocales":[""],"fallbackLocale":""}}},"rootView":{"viewName":"energitune.powermatch.view.Main","type":"XML","id":"mainView","async":true},"resources":{"css":[{"uri":"css/style.css"}]}}}',
	"energitune/powermatch/view/Main.view.xml":'<mvc:View controllerName="energitune.powermatch.controller.Main" xmlns="sap.m" xmlns:m="sap.m"\n   xmlns:mvc="sap.ui.core.mvc" xmlns:u="sap.ui.unified" xmlns:layout="sap.ui.layout" xmlns:core="sap.ui.core"\n   displayBlock="true"><Shell><App><pages><Page showHeader="false"><customHeader><Bar><contentLeft><Image src="img/PowerMatch_logo.png" height="30px" /></contentLeft><contentMiddle></contentMiddle><contentRight></contentRight></Bar></customHeader><content><VBox class="sapUiSmallMargin sapUiResponsiveContentPadding" renderType="Bare"><HBox alignItems="Top" renderType="Bare"><layout:Grid defaultSpan="L12 M12 S12" hSpacing="1" vSpacing="0"><layout:content><Panel expandable="false" headerText="{i18n>consumptionPanel}"\n                                 class="sapUiSmallMarginBottom"><layout:Grid defaultSpan="L12 M12 S12" hSpacing="2" vSpacing="1"><core:HTML id="myChart" content="&lt;canvas id=\'chartCanvas\'&gt;&lt;/canvas&gt;"\n                                       xmlns:core="sap.ui.core" /></layout:Grid></Panel></layout:content></layout:Grid><layout:Grid defaultSpan="L12 M12 S12" hSpacing="1" vSpacing="0"><layout:content><Panel expandable="false" headerText="{i18n>detailsPanel}" class="sapUiSmallMarginBottom"><layout:Grid defaultSpan="L12 M12 S12" hSpacing="2" vSpacing="1"><layout:content><layout:Grid defaultSpan="L4 M12 S12" hSpacing="0" vSpacing="0"><layout:content><ObjectStatus title="{i18n>hdrDateFrom}"\n                                                text="{readingsModel>/header/4/hdrDateFrom}" /></layout:content><layout:content><ObjectStatus title="{i18n>hdrDateTo}"\n                                                text="{readingsModel>/header/3/hdrDateTo}" /></layout:content></layout:Grid></layout:content><layout:content><ObjectStatus title="{i18n>hdrCPE}" text="{readingsModel>/header/1/hdr2}" /></layout:content><layout:content><ObjectStatus title="{i18n>hdrCounterNr}"\n                                          text="{readingsModel>/header/2/hdr3}" /></layout:content><layout:content><ObjectStatus title="{i18n>hdrAddress}" text="{readingsModel>/header/0/hdr1}" /></layout:content></layout:Grid></Panel><Panel expandable="false" headerText="{i18n>consumptionPanelKwh}"\n                                 class="sapUiSmallMarginBottom"><layout:Grid defaultSpan="L12 M12 S12" hSpacing="2" vSpacing="1"><layout:content><layout:Grid defaultSpan="L6 M12 S12" hSpacing="0" vSpacing="0"><layout:content><ObjectStatus title="{i18n>hdrTtlConsEmpty}"\n                                                text="{readingsModel>/header/5/hdrTtlConsEmpty}" /></layout:content><layout:content><ObjectStatus title="{i18n>hdrTtlCons}"\n                                                text="{readingsModel>/header/8/hdrTtlCons}" /></layout:content></layout:Grid></layout:content><layout:content><ObjectStatus title="{i18n>hdrTtlConsRush}"\n                                          text="{readingsModel>/header/6/hdrTtlConsRush}" /></layout:content><layout:content><ObjectStatus title="{i18n>hdrTtlConsFull}"\n                                          text="{readingsModel>/header/7/hdrTtlConsFull}" /></layout:content><layout:content></layout:content></layout:Grid></Panel></layout:content></layout:Grid></HBox><u:FileUploader id="fileUploader" name="uploadExcel" fileType="xlsx" change=".onFileUpload"\n                        placeholder="{i18n>fileUpdPalceHolder}" width="30rem" class="sapUiSmallMarginBottom" /><Table id="excelTable" items="{readingsModel>/data}" inset="false" growing="true"\n                        growingScrollToLoad="true"><columns><Column><Text text="{i18n>colHdrSupplierName}" /></Column><Column><Text text="{i18n>colHdrTariff}" /></Column><Column hAlign="End"><Text text="{i18n>colHdrTotalSimple}" /></Column><Column hAlign="End"><Text text="{i18n>colHdrTotalBiHourly}" /></Column><Column hAlign="End"><Text text="{i18n>colHdrTotalTriHourly}" /></Column></columns><items><ColumnListItem><cells><Text text="{readingsModel>supplierName}" /><Text text="{readingsModel>tariff}" /><Text\n                                    text="{path: \'readingsModel>totalSimple\', formatter: \'.formatter.formatCurrency\'}" /><Text\n                                    text="{path: \'readingsModel>totalBiHourly\', formatter: \'.formatter.formatCurrency\'}" /><Text\n                                    text="{path: \'readingsModel>totalTriHourly\', formatter: \'.formatter.formatCurrency\'}" /></cells></ColumnListItem></items></Table></VBox></content></Page></pages></App></Shell></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map

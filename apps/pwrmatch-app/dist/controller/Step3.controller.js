sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/Dialog","sap/m/Button","sap/m/Title","sap/m/Text","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/model/json/JSONModel"],function(e,t,i,o,n,s,a,r){"use strict";return e.extend("simulador.controller.Step3",{onInit:function(){var e=new r({powers:[{key:"3.45",text:"3.45 kW"},{key:"6.9",text:"6.9 kW"}],tariffs:[],selectedPower:"3.45",selectedSupplier:null,selectedTariff:null});this.getView().setModel(e)},onSupplierChange:function(e){var t=e.getParameter("selectedItem").getKey();var i=this.getOwnerComponent().getModel("suppliers").getData().suppliers;var o=i.find(e=>e.id===t);var n=o?o.tariffs.map(e=>({key:e.id,text:e.name,details:e})):[];this.getView().getModel().setProperty("/tariffs",n)},onShowDetails:function(){var e=this.getView().getModel();var t=e.getProperty("/selectedSupplier");var i=e.getProperty("/selectedTariff");if(!t||!i){sap.m.MessageToast.show("Escolha fornecedor e tarifário");return}var o=t;var n=this.getOwnerComponent().getModel("suppliers").getData().suppliers;var s=n.find(e=>e.id===o);var a=(s.tariffs||[]).find(e=>e.id===i);this._openDetailsDialog(s,a)},_openDetailsDialog:function(e,n){var s=this;if(!this._oDlg){this._oDlg=new t({title:"{/title}",content:[new sap.m.Text({text:"{/subtitle}"}),new sap.m.IconTabBar({items:[new sap.m.IconTabFilter({icon:"sap-icon://money",text:"Preços",content:new sap.m.Table({columns:[new sap.m.Column({header:new o({text:"Descrição"})}),new sap.m.Column({header:new o({text:"Valor"})})],items:{path:"/priceRows",template:new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"{description}"}),new sap.m.Text({text:"{value}"})]})}})}),new sap.m.IconTabFilter({icon:"sap-icon://hint",text:"Condições",content:new sap.m.List({items:{path:"/conditions",template:new sap.m.StandardListItem({title:"{title}",description:"{desc}"})}})})]})],endButton:new i({text:"Fechar",press:function(){s._oDlg.close()}})})}var a=new r({title:e.name+" / "+n.name+" / "+this.getView().getModel().getProperty("/selectedPower"),subtitle:"Detalhes do tarifário",priceRows:[{description:"Potência",value:n.prices.power},{description:"Vazio",value:n.prices.vazio},{description:"Cheio",value:n.prices.cheio},{description:"Ponta",value:n.prices.ponta}],conditions:n.conditions||[]});this._oDlg.setModel(a);this._oDlg.open()},onBack:function(){this.getOwnerComponent().getRouter().navTo("step2")},onSimulate:function(){var e=this.getOwnerComponent().getModel("viewModel");var t=this.getView().getModel().getData();e.setProperty("/stepData/selection",t);this.getOwnerComponent().getRouter().navTo("step4")}})});
//# sourceMappingURL=Step3.controller.js.map
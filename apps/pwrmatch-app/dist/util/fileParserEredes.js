sap.ui.define(["sap/base/Log","sap/ui/model/json/JSONModel"],function(e,a){"use strict";function r(e,a){var r=a.slice(0,3).map((e,a)=>({[`hdr${a+1}`]:e[1]}));var t=a.slice(8).filter(e=>e[0]&&e[5]&&e[6]&&e[7]).map(e=>({date:e[0].split("/")[2]+"-"+e[0].split("/")[1]+"-"+e[0].split("/")[0],day:e[0].split("/")[0],readingEmpty:e[5],readingFull:e[7],readingRush:e[6]}));var s=t.sort((e,a)=>new Date(a.date)-new Date(e.date));var n=s[0];r.push({["hdrDateTo"]:n.date});s=t.sort((e,a)=>new Date(e.date)-new Date(a.date));var d=s[0];r.push({["hdrDateFrom"]:d.date});t.forEach(function(e,a,r){if(a===0){e.toDate=r[a].date;e.readEmpty=r[a].readingEmpty;e.readFull=r[a].readingFull;e.readRush=r[a].readingRush;e.consEmpty=e.readingEmpty-d.readingEmpty;e.consFull=e.readingFull-d.readingFull;e.consRush=e.readingRush-d.readingRush}else{e.fromDate=r[a-1].date;e.toDate=r[a].date;e.readEmpty=r[a].readingEmpty;e.readFull=r[a].readingFull;e.readRush=r[a].readingRush;e.consEmpty=e.readingEmpty-r[a-1].readingEmpty;e.consFull=e.readingFull-r[a-1].readingFull;e.consRush=e.readingRush-r[a-1].readingRush;e.simple=e.consEmpty+e.consFull+e.consRush}});var i={header:r,consReadRows:t};return i}return{parseEredesFile:function(t,s){try{var n=new Uint8Array(s.target.result);var d=XLSX.read(n,{type:"array"});var i=d.SheetNames[0];var u=d.Sheets[i];var l=XLSX.utils.sheet_to_json(u,{header:1});var o=[];switch(i){case"Leituras":o=r(t,l);break;default:}e.info("Excel carregado com sucesso");return o}catch(r){e.error("Erro ao processar Excel: "+r.message);return new a([])}}}});
//# sourceMappingURL=fileParserEredes.js.map
<mvc:View controllerName="simulador.controller.Main"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:core="sap.ui.core"
  xmlns:l="sap.ui.layout"
  xmlns:m="sap.m"
  xmlns:u="sap.ui.unified"
  xmlns="sap.m">
  <Page title="{i18n>appTitle}" class="sapUiResponsivePadding--header sapUiResponsivePadding--footer" showNavButton="false" floatingFooter="true">

    <content>

      <l:Grid defaultSpan="L6 M6 S12" hSpacing="1" vSpacing="1"
        xmlns:l="sap.ui.layout">

        <l:content>
          <!-- eRedes readings option panel -->

          <Panel headerText="{i18n>optionReadingsTtl}" class="sapUiSmallMarginTop">

            <l:Grid defaultSpan="L6 M6 S12" hSpacing="0" vSpacing="0"
              xmlns:l="sap.ui.layout">

              <l:content>

                <RadioButtonGroup selectedIndex="{= ${/optionValEFRVisible} ? 0 : 1 }" select=".onOptionReadings">
                  <buttons>
                    <RadioButton text="{i18n>optionReadingsEredes}" />
                    <RadioButton text="{i18n>optionReadingsNoEredes}" />
                  </buttons>
                </RadioButtonGroup>
              </l:content>

              <l:content>
                <VBox justifyContent="Center" alignItems="End">
                  <Link text="{i18n>optionReadingsHelp}" endIcon="sap-icon://inspect" press=".onOpenImageStepsDialog" />
                </VBox>
              </l:content>

            </l:Grid>
          </Panel>



        </l:content>

        <l:content>
          <!-- Manual consuption/readungs input option panel -->
          <Panel headerText="{i18n>optionValTtl}" class="sapUiSmallMarginTop" visible="{= !${/optionValEFRVisible} }">

            <l:Grid defaultSpan="L6 M6 S12" hSpacing="0" vSpacing="0"
              xmlns:l="sap.ui.layout">

              <l:content>
                <VBox justifyContent="End" alignItems="Start">
                  <Text text="{i18n>optionVal}" />
                </VBox>
              </l:content>

              <l:content>
                <VBox justifyContent="Center" alignItems="End">
                  <Link text="{i18n>valEFRHelp}" endIcon="sap-icon://inspect" press=".onOpenImageStepsDialog" />
                </VBox>
              </l:content>

            </l:Grid>

            <l:Grid defaultSpan="L12 M12 S12" hSpacing="0" vSpacing="0"
              xmlns:l="sap.ui.layout">

              <l:content>
                <RadioButtonGroup select=".onOptionValEFRSelect" columns="4">
                  <buttons>
                    <RadioButton text="{i18n>optionEFRValTypeC}" />
                    <RadioButton text="{i18n>optionEFRValTypeR}" />
                    <RadioButton text="{i18n>optionEFRValTypeCR}" />
                    <RadioButton text="{i18n>optionEFRValNo}" />
                  </buttons>
                </RadioButtonGroup>
              </l:content>

              <l:content>
                <VBox justifyContent="Center" alignItems="Start" visible="{= ${/optionValEFRMsgVisible} }" class="sapUiSmallMarginTop">
                  <HBox backgroundDesign="Solid">
                    <MessageStrip class="sapUiTinyMarginBottom sapUiSmallMarginBegin" text="{= ${/optionValEFRMsg} }" type="{=
                      ${/optionValEFRMsgType} === 3 ? 'Error'
                      : ${/optionValEFRMsgType} === 2 ? 'Warning'
                      : ${/optionValEFRMsgType} === 1 ? 'Information'
                      : 'Success'
                    }" showIcon="true">
                    </MessageStrip>

                  </HBox>
                </VBox>
              </l:content>

            </l:Grid>

          </Panel>
        </l:content>

      </l:Grid>

      <!-- eRedes file drop/upload zone panel -->
      <l:Grid defaultSpan="L6 M6 S12" hSpacing="1" vSpacing="1"
        xmlns:l="sap.ui.layout">

        <l:content>
          <Panel headerText="{i18n>uploadPanel}" class="sapUiSmallMarginTop" visible="{= ${/optionValEFRVisible} }">
            <VBox id="uploadContainer" renderType="Bare" class="uploadArea">
              <core:HTML content='
            &lt;div id="dropzone" style="border:2px dashed #ccc; padding:20px; text-align:center;"&gt;{i18n>dropZoneText} {i18n>orDropHere}&lt;/div&gt;
            &lt;input type="file" id="fileInput" style="display:none"/&gt;
            ' />
            </VBox>
          </Panel>
        </l:content>

      </l:Grid>

      <!-- Table for readings/consuption registration panel -->
      <l:Grid defaultSpan="L12 M12 S12" hSpacing="1" vSpacing="1"
        xmlns:l="sap.ui.layout">

        <l:content>
          <Panel headerText="{i18n>tableTtl}" visible="{= !${/optionValEFRVisible} }">
            <headerToolbar>
              <OverflowToolbar>
                <Title text="{i18n>tableTtl}"/>
                <ToolbarSpacer />
                <m:Button text="{i18n>checkMsg}" icon="sap-icon://message-popup" tooltip="{i18n>addRow}" press=".onShowCheckedMsgs" class="sapUiSmallMarginEnd"/>
                <m:Button text="{i18n>checkRows}" icon="sap-icon://survey" tooltip="{i18n>addRow}" press=".onCheckConsumptions" class="sapUiSmallMarginEnd"/>
                <m:Button text="{i18n>addRow}" icon="sap-icon://sys-add" tooltip="{i18n>addRow}" press=".onAddRow"/>
              </OverflowToolbar>
            </headerToolbar>
            <Table id="tblManual" items="{appDataModel>/consumptions}">
              <!--
              <headerToolbar>
                <m:OverflowToolbar style="Clear">
                  <m:Title id="title" text="{i18n>tableTtl}"/>
                  <m:ToolbarSpacer/>
                  <m:Button text="{i18n>addRow}" icon="sap-icon://sys-add" tooltip="{i18n>addRow}" press=".onAddRow"/>
                </m:OverflowToolbar>
              </headerToolbar>
              -->
              <columns>
                <Column width="30px"></Column>
                <Column>
                  <Text text="{i18n>colFromDate}" />
                </Column>
                <Column>
                  <Text text="{i18n>colToDate}" />
                </Column>
                <Column>
                  <Text text="{i18n>colSimple}" />
                </Column>
                <Column visible="{= ${/consColsVisible} }">
                  <Text text="{i18n>colConsVazio}" />
                </Column>
                <Column visible="{= ${/consColsVisible} }">
                  <Text text="{i18n>colConsCheio}" />
                </Column>
                <Column visible="{= ${/consColsVisible} }">
                  <Text text="{i18n>colConsPonta}" />
                </Column>
                <Column visible="{= ${/readColsVisible} }">
                  <Text text="{i18n>colReadVazio}" />
                </Column>
                <Column visible="{= ${/readColsVisible} }">
                  <Text text="{i18n>colReadCheio}" />
                </Column>
                <Column visible="{= ${/readColsVisible} }">
                  <Text text="{i18n>colReadPonta}" />
                </Column>
                <Column hAlign="Center" width="4rem"></Column>
              </columns>
              <items>
                <ColumnListItem>
                  <cells>
                    <HBox alignItems="Center">
                      <ObjectStatus press=".onShowCheckedMsgs"
                      class="sapUiSmallMarginBottom" active="true" inverted="false" state="{appDataModel>checkState}" icon="sap-icon://message-success" visible="{= ${appDataModel>checkState} === 'Success' }" />
                      <ObjectStatus press=".onShowCheckedMsgs"
                      class="sapUiSmallMarginBottom" active="true" inverted="false" state="{appDataModel>checkState}" icon="sap-icon://message-error" visible="{= ${appDataModel>checkState} === 'Error' }" />
                      <ObjectStatus press=".onShowCheckedMsgs"
                      class="sapUiSmallMarginBottom" active="true" inverted="false" state="{appDataModel>checkState}" icon="sap-icon://message-warning" visible="{= ${appDataModel>checkState} === 'Warning' }" />
                      <ObjectStatus press=".onShowCheckedMsgs"
                      class="sapUiSmallMarginBottom" active="true" inverted="false" state="{appDataModel>checkState}" icon="sap-icon://message-information" visible="{= ${appDataModel>checkState} === 'Information' }" />
                    </HBox>
                    <DatePicker value="{
						                    'path':'appDataModel>fromDate',
						                    'type':'sap.ui.model.type.Date',
						                    'formatOptions': {
							                    'pattern': 'dd/MM/yyyy'
						                    }
					                    }" required="false" />
                    <DatePicker value="{
						                    'path':'appDataModel>toDate',
						                    'type':'sap.ui.model.type.Date',
						                    'formatOptions': {
							                    'pattern': 'dd/MM/yyyy'
						                    }
					                    }" required="false" />
                    <Input value="{
                            path: 'appDataModel>consumptionSimple',
                            type: 'sap.ui.model.type.Float',
                            constraints: {minimum: 0},
                            formatOptions: {maxFractionDigits: 2}
                            }" required="false" />
                    <Input value="{appDataModel>consumptionEmpty}" type="Number"/>
                    <Input value="{appDataModel>consumptionFull}" type="Number"/>
                    <Input value="{appDataModel>consumptionRush}" type="Number"/>
                    <Input value="{appDataModel>readingsEmpty}" type="Number"/>
                    <Input value="{appDataModel>readingsFull}" type="Number"/>
                    <Input value="{appDataModel>readingsRush}" type="Number"/>
                    <Button icon="sap-icon://delete" type="Transparent" press=".onDeleteRow" />
                  </cells>
                </ColumnListItem>
              </items>
            </Table>
          </Panel>
        </l:content>

      </l:Grid>

    </content>
    <!-- Footer buttons -->
    <footer>
      <OverflowToolbar>
        <ToolbarSpacer/>
        <Button text="{i18n>toSimulation}" icon="sap-icon://navigation-right-arrow" press=".onNextFromMain"></Button>
      </OverflowToolbar>
    </footer>
  </Page>
</mvc:View>